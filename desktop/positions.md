# Компоновка

87

WPF Окно может содержать только один элемент. Чтоб поместить более одного элемента нужно применять контейнер и добавлять элементы уже в этот контейнер.

Идеальное окно WPF следует принципам:

- Элементы не должны иметь явно установленных размеров. Можно только устанавливать ограничения на максимальный и минимальный размер.

- Элементы не указывают свою позицию в экранных координатах. Используются размеры, пробелы, отступы, интервалы.

- Элементы компоновки разделяют доступное пространство между своими дочерними элементами.

- Контейнеры могут быть вложенными.

Если придерживаться этих принципов, то в итоге можно получить идеальный WPF-подобный клиентский интерфейс.

Все контейнеры компоновки WPF являются панелями, унаследованными от абстрактного класса System.Windows.Controls.Panel. В этом классе дополнительно реализованы три дополнительные свойства: Background - кисть для рисования фона панели; Children - коллекция находящихся в панели элементов; IsItemsHost - булевское true, если панель используется для отображения множества элементов, ассоциированных с ItemsControl.

## Свойства компоновки

Панели компоновки взаимодействуют со своими дочерними элементами через небольшой набор свойств компоновки. Все такие свойства поддерживаются всеми графическими элементами WPF.

### Выравнивание

Свойства HorizontalAlignment и VerticalAlignment определяют позиционирование дочернего элемента внутри контейнера компоновки, когда имеется дополнительное пространство. 

По умолчанию HorizontalAlignment равно Left для меток и Stretch - для кнопок и самих панелей.

Пример:

```csharp
<StackPanel>
    <Button HorizontalAlignment="Center">Center</Button>
    <Button HorizontalAlignment="Left">Left</Button>
    <Button HorizontalAlignment="Right">Right</Button>
    <Button>Full</Button>
</StackPanel>
```

### Отступы

Свойство Margin является экземпляром структуры Tickeness, с отдльными компонентами для верхней, нижней, левой и правой граней.

При установке отступов для элементов допускается устанавливать одинаковое значение для всех сторон.

Пример:

```csharp
<Button Margin="5">Center</Button>
```

Допускается устанавливать значение отступа для каждой стороны элемента управления в порядке левое, верхнее, правое и нижнее.

Пример:

```csharp
<Button Margin="5,10,5,15">Center</Button>
```

## Позиционирование внутри панелей StackPanel

Элемент управления StackPanel укладывает свои дочерние элементы вдоль одиночной строки, которая может быть ориентирована горизонтально или вертикально (по умолчанию) в зависимости от значения, присвоенного свойству Orientation. 

StackPanel не пытается переносить содержимое при изменении размера окна пользователем. Взамен элементы в StackPanel просто растягиваются (согласно выбранной ориентации), приспосабливаясь к размеру самой панели StackPanel.

Панель StackPanel как правило используется как вложенная панель в какой-нибудь главной панели.

```csharp
<StackPanel Background="LightSteelBlue" Orientation ="Vertical">
    <Label Name="LabelInstruction1" FontSize="15" Content="Instruction1"/>
    <Label Name="LabelInstruction2" FontSize="15" Content="Instruction2"/>
</StackPanel>
```

## Позиционирование внутри панелей Canvas

Панель Canvas делает возможным абсолютное позиционирование содержимого пользовательского интерфейса.

Для каждого элемента управления необходимо указать левый верхний угол с использованием свойств Canvas.Тор и Canvas.Left. Правый нижний угол каждого элемента управления можно задать неявно, устанавливая свойства Canvas.Height и Canvas.Width. 

Наилучшим применением типа Canvas является позиционирование графического содержимого.

```csharp
<Canvas Background="LightsteelBlue">
    <Label x:Name="LabelTest" Canvas.Left="17" Canvas.Top="155" Content="Test"/>
</Canvas>
```

## Позиционирование внутри панелей WrapPanel

Размещает элементы в последовательностях строк с переносом.

Панель WrapPanel позволяет определять содержимое, которое будет протекать сквозь панель, когда размер окна изменяется. При позиционировании элементов внутри WrapPanel их координаты верхнего левого и правого нижнего углов не указываются, как обычно делается в Canvas. Однако для каждого подэлемента допускается определение значений свойств Height и Width.

Панель WrapPanel (как и ряд других типов панелей) может быть объявлена с указанием значений ItemWidth и ItemHeight, которые управляют стандартным размером каждого элемента.

WrapPanel будет подэлементом панели другого типа, позволяя небольшой области окна переносить свое содержимое при изменении размера.

```csharp
<WrapPanel Background="LightSteelBlue">
    <Label x:Name="LabelInstruction" Width="328" Height="25" FontSize="15" Content="Instruction"/>
</WrapPanel>
```

## Позиционирование внутри панелей Grid

Выравнивает содержимое в строки или колонки невидимой таблицы. Аналогично таблице HTML панель Grid может состоять из набора ячеек, каждая из которых имеет свое содержимое.

При определении Grid нужно определить и сконфигурировать каждую колонку, строку и назначить содержимое каждой ячейки сетки с применением синтаксиса присоединяемых свойств. Определение колонок и строк выполняются с использованием элементов Grid.ColumnDefinitions и Grid.RowDefinitions. Они содержат коллекции элементов ColumnDefinition и RowDefinition соответственно.

Задавать размеры столбцов и строк в панели Grid можно одним из трех способов:

- установка абсолютных размеров (например, 100);

- установка автоматических размеров;

- установка относительных размеров (например, 3*).

Панели Grid также способны поддерживать разделители типа GridSplitter.

```csharp
<Grid ShowGridLines="True" Background ="LightSteelBlue">
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="l*" />
        <ColumnDefinition Width="3*" />
    </Grid.ColumnDefinitions>
    <Label х:Name="LabelInstruction1" Grid.Column ="0" Grid.Row ="0" FontSize="T5" Content="Left"/>
    <GridSplitter Grid.Column ="0" Width ="5"/>
    <Label х:Name="LabelInstruction2" Grid.Column ="0" Grid.Row ="0" FontSize="T5" Content="Right"/>
</Grid>
```

## Позиционирование внутри панелей DockPanel

Выравнивает элементы по краю контейнера.

Панель DockPanel обычно применяется в качестве контейнера, который содержит любое количество дополнительных панелей для группирования связанного содержимого. Панели DockPanel используют синтаксис присоединяемых свойств для управления местом, куда будет пристыковываться каждый элемент внутри DockPanel.

```csharp
<DockPanel LastChildFill="True" Background="AliceBlue">
    <Label DockPanel.Dock="Left" Name="LabelMake" Content="Make"/>
    <Button Name="ButtonOK" Content="OK"/>
</DockPanel>
```

## Позиционирование внутри панели UniformGrid

Помещает элементы в невидимуют таблицу, устанавливая одинаковый размер для всех ячеек.



## Прокрутка

В инфраструктуре WPF поставляется класс ScrollViewer, который обеспечивает автоматическое поведение прокрутки данных внутри объектов панелей.

```csharp
<ScrollViewer>
    <StackPanel>
        <Button Content="Первая" Background="Green" Height="50"/>
    </StackPanel>
</ScrollViewer>
```












