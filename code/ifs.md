# Ветвления

Для изменения потока выполнения программы на основе разнообразных обстоятельств в C# определены простые конструкции:

- оператор if/else

- оператор switch

## Оператор if/else

Оператор этот в C# работает только с булевскими значениями. 

Пример:

```csharp
if (true) 
{
    //выполнить если истинна
}
else
{
    //выполнить если ложь
}
```

## Сопоставление с образцом

Можно проверять тип объекта с применением ключевого слова is, присваивать данный объект переменной в случае соответствия образцу и затем использовать эту переменную.

Пример:

```csharp
if (sample is int value)
{
    Console.WriteLine($"{value} is an int"); // имеет тип int
}
```

Внесено множество улучшений в сопоставление с образцом:

Образцы с типами - проверяют, относится ли эта переменная к тому или иному типу

Образцы в курглых скобках - усиливают или подчеркивают сочетания образцов

And образцы - требуют соответствия обоим образцам

Or образцы - требуют соответствия какому-либо одному из образцов

Not образцы - требуют несоответствия образцу

Относительные образцы - Требуют, чтобы переменная была меньше, меньше или равна, больше, больше или равна образцу

Пример:

```csharp
object sample = 123;
Type t = typeof(string);
char c = 'f';
if (t is Type)
{
    // Образцы типов
}
if (c is >= 'a' and <= 'z' or >= 'A' and <= 'Z')
{
    // Относительные, конъюктивные и дизъюктивные образцы
}
if (c is (>= 'a' and <= 'z') or (>= 'A' and <= 'Z') or '.' or ',')
{
    // Образцы в скобках
}
if (sample is not null)
{
    // Инвертированные образцы
}
record Point(int X, int Y);
var point = new Point(1, 1);
if (point is { X: > 0, Y: > 0 })
{
    // Сопоставление с образцом, учитывая значения свойств
}
```

## Условная операция

Условный оператор (?:) относится к числу самых примечательных в C#. Он представляет собой условный оператор и может заменить конструкцию if-then-else.

```csharp
bool b = true;
var x = (b) ? "dss" : "dss";
```

## Логические операции

&&      Операция "И"

||      Операция "ИЛИ"

!       Операция "НЕ"

Операции && и || при необходимости поддерживают сокращенный путь выполнения. Другими словами, после того, как было определено, что сложное выражение должно дать в результате false, оставшиеся подвыражения вычисляться не будут. Если требуется, чтобы все выражения вычислялись безотносительно к чему-либо, тогда можно использовать операции & и |. Дополнительно поддерживаниется оператор исключающего или ^.

## Оператор switch

Предназначен для разветвления процесса выполения программы. Оператор switch позволяет организовать выполнение программы на основе заранее определенного набора вариантов. Блок default обрабатывает недопустимый выбор.

```csharp
switch(value)
{
    case 1: WriteLine("1");
        break;
    case 2:
    case 3: WriteLine("1");
         break;
    default: WriteLine("def");
        break;
}
```

Язык C# требует, чтобы каждый блок case (включая default), который содержит исполняемые операторы, завершался оператором return, break или goto во избежание сквозного прохода по блокам. Вдобок к числовым значениям C# способен оценивать типы данных char, string, bool, int, long и Enum.

Пример с типом string:

```csharp
switch(strValue)
{
    case "one": WriteLine("1");
        break;
    case "two"
    case "three": WriteLine("1");
        break;
    default: WriteLine("def");
        break;
}
```

Пример с типом enum - DayOfWeek.

```csharp
switch(favDay)
{
    case DayOfWeek.Sunday: WriteLine("1");
        break;
    case DayOfWeek.Monday:
    case DayOfWeek.Thursday: WriteLine("1");
        break;
    default: WriteLine("def");
        break;
}
```

### Сопоставление с образцом switch

В C# операторы switch способны также задействовать образец с типами, при котором операторы case могут оценивать тип проверяемой переменной, и выражения case больше не ограничиваются константными значениями. Правило относительно того, что каждый оператор case должен завершаться с помощью return или break, по-прежнему остается в силе, тем не менее, операторы goto не поддерживают применение образца с типами.

Пример простой:

```csharp
switch(choise)
{
    case int i: WriteLine($"Целое: {i}");
        break;
    case string s: WriteLine($"Строка: {s}");
        break;
    default: WriteLine("Неизвестное");
        break;
}
```

Добавление конструкции when для оценки условий на переменной:

```csharp
switch(choise)
{
    case int i when i == 1:
    case string s when s.Equals("one"):
        WriteLine($"Что-то равно еденице");
        break;
    case int i when i == 2:
    case string s when s.Equals("two"):
        WriteLine($"Что-то равно двум");
        break;
    case int _: //отбрасывание
        WriteLine("Это какое-то число");
        break;
    default: WriteLine("Неизвестное");
        break;
}
```

## Выражения switch

В C# есть выражения switch, позволяющие присваивать значение переменной в лаконичном операторе.

Простой пример:

```csharp
var index = 1;
string str = index switch
{
    1 => "красный",
    2 => "оранжевый",
    3 => "синий",
    _ => "непонятный",
};
```

Пример с кортежами:

```csharp
string first = "rock";
string second = "paper";
var rez = (first, second) switch
{
    ("rock", "paper") => "Paper wins.",
    ("rock", "scissors") => "Rock wins.",
    ("paper", "rock") => "Paper wins.",
    ("paper", "scissors") => "Scissors wins.",
    ("scissors", "rock") => "Rock wins.",
    ("scissors", "paper") => "Scissors wins.",
    (_, _) => "Tie.",
};
```

Пример использования кортежей внутри функции, в качестве входного параметра - кортеж:

```csharp
static string GetVal((string one, string two) value)
{
    return value switch
    {
        ("one", "two") => "OneTwo",
        (_) => "Default",
    };
}
```

Также можно применять инструкцию when для оценки условий на переменной:

```csharp
object obj = 2;
string string3 = obj switch
{
    int i when i >= 1 && i <= 10 => "целое число в пределах нормы",
    string _ => "это вообще какая то строка",
    int => "это какое-то число",
    _ => "это непонятно что",
};
```