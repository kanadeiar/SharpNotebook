# NET 5 EF Core 5

## Аннотации данных EF

Аннотация данных         | Описание
-------------------------|-------------------------
Table                    | Описание таблицы и сущности для сущности
Column                   | Значение колонки для свойства модели
Key                      | Главный ключ модели, включает также аннотацию [Required]
Required                 | Свойство не может быть нулевым в модели
ForeignKey               | Свойство, которое должно быть внешним ключом навигационного свойства модели
InverseProperty          | Объявляет навигационное свойство на другом конце отношений
StringLength             | Максимальная длинна строкового свойства модели
TimeStamp                | Тип строки, опредяющей проверку конкуренктного доступа к записи при производстве действий с сущностью
ConcurrencyCheck         | Флаговое поле должно быть использовано при проверке конкуренктного доступа
DatabaseGenerated        | Спецификация как поле будет генерироваться базой данных - вычисляемое, идентификатор или отсутствует
DataType                 | Описание более специфичного типа поля
NotMapped                | Исключение свойства в классе из учета, не будет создано в базе данных

## Контекст базы данных

Должен быть унаследован от DbCOntext. 

Главные члены:

Компонент                | Описание
-------------------------|-------------------------
Database                 | Описывает доступ к зависимым от базы данных информации и функциональности + сырой SQL
Model                    | Данные по форме сущности, отношения между ними и как они проецируются на базу данных.
ChangeTracker            | Предоставляет доступ к информации и операциям для инстансов сущностей этого контекста
DBSet<T>                 | Используется для запросов и сохранения массивов сущностей приложения. LINQ транслируется прямо в код SQL.
Entry, Entry<Entity>     | Предоставляет доступ к отслеживанию сущностей, измению их статуса. Также может быть вызвано на сущности не отслеживаемой для установки отслеживания.
SaveChanges, SaveChangesAsync | Сохранение всех воздействий на базу данных в базе данных и возвращает число затронутых сущностей.
OnConfiguring            | Используется для создания и модификации опций контекста. Исполняется каждый раз как создается контекст. Желательно использовать DbContextOptions во время выполнения и IDesignTimeDbContextFactory во время разработки.
OnModelCreating          | Вызывается когда модель инициализирована, но перед финализацией.

Библиотека доступа к данным.

Методы Database предназначенные для удаления и воссоздания базы данных:

Методы                   | Описание
-------------------------|-------------------------
EnsureDeleted()          | Удаляет базу данных, если она существует
EnsuteCreated()          | Создает базу данных на основе файла <...>ModelSnapshot.cs
Migrate()                | Создает базу данных и выполняет все миграции, если они сущетвует. 

## Библиотека доступа к данным - "StudentsDAL".

Пакеты:

- Microsoft.EntityFrameworkCore.SqlServer

- Microsoft.EntityFrameworkCore.Tools




## Библиотека моделей доступа к данным - "StudentsDAL.Models".

Модели данных:



## Консольное приложение разработки библиотеки - "StudentsDAL.TestDriver".

Для включения управления с помощью консоли:
```csharp
<ItemGroup>
<DotNetCliToolReference Include="Microsoft.EntityFrameworkCore.Tools.DotNet" Version="2.0.0" />
</ItemGroup>
```
Команды: dotnet ef,    dotnet ef migrations add Initial,      dotnet ef database update

